<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GAS Endpoint Test</title>
</head>
<body>
    <h1>GAS Endpoint Test</h1>
    <div id="output"></div>
    <script src="config.js"></script>
    <script type="module">
        import { CloudSync } from "./cloudSync.js";

        // Mock dependencies if needed, or just rely on them loading if they are present.
        // cloudSync imports onedriveAuth and auth. We might need to ensure they don't crash on import.
        // Assuming they are clean imports (no side effects on load that break without browser env).

        const mockStorage = {
            getSettings: () => ({
                gasEndpoint: "https://example.com/from/settings"
            })
        };

        const cloudSync = new CloudSync(mockStorage);
        const output = document.getElementById("output");

        try {
            const endpoint = cloudSync.getGasEndpoint();
            
            let result = "";
            result += "Config GAS Endpoint: " + (window.APP_CONFIG?.GAS_SYNC_ENDPOINT || "undefined") + "<br>";
            result += "Resolved Endpoint: " + endpoint + "<br>";
            
            if (window.APP_CONFIG?.GAS_SYNC_ENDPOINT && endpoint === window.APP_CONFIG.GAS_SYNC_ENDPOINT.replace(/\/$/, "")) {
                 result += "<strong>SUCCESS: used config.js endpoint</strong>";
            } else {
                 result += "<strong>FAILURE: did not use config.js endpoint</strong>";
            }
            output.innerHTML = result;

        } catch (e) {
            output.textContent = "Error: " + e.message;
            console.error(e);
        }
    </script>
</body>
</html>
